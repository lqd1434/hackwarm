{"remainingRequest":"/Users/lqd/WebstormProjects/warm/node_modules/babel-loader/lib/index.js!/Users/lqd/WebstormProjects/warm/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/lqd/WebstormProjects/warm/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lqd/WebstormProjects/warm/src/components/Main.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lqd/WebstormProjects/warm/src/components/Main.vue","mtime":1618735501399},{"path":"/Users/lqd/WebstormProjects/warm/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lqd/WebstormProjects/warm/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/lqd/WebstormProjects/warm/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/lqd/WebstormProjects/warm/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgY3JlYXRlTmFtZXNwYWNlZEhlbHBlcnMgfSBmcm9tICd2dWV4JzsKY29uc3QgewogIG1hcE11dGF0aW9ucywKICBtYXBBY3Rpb25zLAogIG1hcFN0YXRlCn0gPSBjcmVhdGVOYW1lc3BhY2VkSGVscGVycygnd2FybScpOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ01haW4nLAogIGNvbXB1dGVkOiB7IC4uLm1hcFN0YXRlKFsnaXNTaG93Rm9vdGVyTWVudScsICd1c2VyJywgJ3NvY2tldCcsICd0YWxrVG9XaG8nLCAnbWF4SWQnXSkKICB9LAoKICBtb3VudGVkKCkgewogICAgdGhpcy5vcGVuU29ja2V0KCk7CiAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2hvbWUnKTsKICB9LAoKICBtZXRob2RzOiB7IC4uLm1hcE11dGF0aW9ucyhbJ3Rlc3QnLCAnc2V0U29ja2V0JywgJ2Nsb3NlU29ja2V0JywgJ3NldENoYXRMaXN0JywgJ2FkZE1lc3NhZ2VIaXN0b3J5JywgJ2luY3JlYXNlTWF4SWQnXSksCiAgICAuLi5tYXBBY3Rpb25zKFsnYWRkQ2hhdExpc3RBY3Rpb24nLCAnZ2V0Q2hhdExpc3RBY3Rpb24nXSksCgogICAgZG9UZXN0KCkgewogICAgICB0aGlzLnRlc3QoJ+WTiOWTiCcpOwogICAgICB0aGlzLnRlc3RBY3Rpb24oJ2hoJyk7CiAgICB9LAoKICAgIGFuaW1hdGUoZGF0YSkgewogICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGF0YSk7CiAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNpdGlvbiA9ICd0cmFuc2Zvcm0gMTUwbXMgbGluZWFyJzsKICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2Zvcm1PcmlnaW4gPSAnNTAlIDAlJzsKICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKDIwZGVnKSc7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGVsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gJ3JvdGF0ZSgtMjBkZWcpJzsKICAgICAgfSwgMTUwKTsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgZWxlbWVudC5zdHlsZS50cmFuc2Zvcm0gPSAncm90YXRlKDBkZWcpJzsKICAgICAgfSwgMzAwKTsKICAgIH0sCgogICAgb3BlblNvY2tldCgpIHsKICAgICAgaWYgKHR5cGVvZiBXZWJTb2NrZXQgPT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgY29uc29sZS5sb2coJ+aCqOeahOa1j+iniOWZqOS4jeaUr+aMgVdlYlNvY2tldCcpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCfmgqjnmoTmtY/op4jlmajmlK/mjIFXZWJTb2NrZXQnKTsKICAgICAgICBsZXQgc29ja2V0VXJsID0gJ3dzOi8vMTgyLjI1NC4xNTkuMzc6ODA4MS93cy8nICsgdGhpcy51c2VyLmlkOyAvLyBzb2NrZXRVcmwgPSBzb2NrZXRVcmwucmVwbGFjZSgnaHR0cHMnLCAnd3MnKS5yZXBsYWNlKCdodHRwJywgJ3dzJykKCiAgICAgICAgdGhpcy5zZXRTb2NrZXQobmV3IFdlYlNvY2tldChzb2NrZXRVcmwpKTsgLy8g5omT5byA5LqL5Lu2CgogICAgICAgIHRoaXMuc29ja2V0Lm9ub3BlbiA9ICgpID0+IHsKICAgICAgICAgIHRoaXMuJHRvYXN0KHsKICAgICAgICAgICAgbWVzc2FnZTogJ3dlYnNvY2tldOW3suaJk+W8gCcsCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgICAgfSk7CiAgICAgICAgfTsgLy8g6I635b6X5raI5oGv5LqL5Lu2CgoKICAgICAgICB0aGlzLnNvY2tldC5vbm1lc3NhZ2UgPSBtc2cgPT4gewogICAgICAgICAgY29uc29sZS5sb2cobXNnLmRhdGEpOwogICAgICAgICAgY29uc3QgaW5kZXggPSBtc2cuZGF0YS5pbmRleE9mKCc6Jyk7CiAgICAgICAgICBjb25zb2xlLmxvZyhpbmRleCk7CiAgICAgICAgICBjb25zdCBkYXRlMSA9IG5ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCkucmVwbGFjZSgvXC8vZywgJy0nKTsKICAgICAgICAgIGNvbnN0IHRpbWUxID0gbmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKS5zbGljZSgyKTsKICAgICAgICAgIGNvbnN0IGRhdGUgPSBkYXRlMSArICcg5pe26Ze0ICcgKyB0aW1lMTsKICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7CiAgICAgICAgICAgIGZyb21JZDogcGFyc2VJbnQobXNnLmRhdGEuc2xpY2UoMCwgaW5kZXgpKSwKICAgICAgICAgICAgTGFzdE1zZzogbXNnLmRhdGEuc2xpY2UoaW5kZXggKyAxKSwKICAgICAgICAgICAgQ3JlYXRlZEF0OiBkYXRlCiAgICAgICAgICB9OwogICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7CiAgICAgICAgICB0aGlzLmFkZENoYXRMaXN0QWN0aW9uKG1lc3NhZ2UpOwogICAgICAgICAgdGhpcy5nZXRDaGF0TGlzdEFjdGlvbigpOwogICAgICAgICAgY29uc29sZS5sb2codGhpcy5tYXhJZCArIDEpOwogICAgICAgICAgdGhpcy5pbmNyZWFzZU1heElkKCk7CiAgICAgICAgICBjb25zdCBtZXNzYWdlMiA9IHsKICAgICAgICAgICAgaWQ6IHRoaXMubWF4SWQgKyAxLAogICAgICAgICAgICBjcmVhdGVkX2F0OiBkYXRlLAogICAgICAgICAgICBmcm9tOiBtZXNzYWdlLmZyb21JZCwKICAgICAgICAgICAgdG86IHRoaXMudXNlci5pZCwKICAgICAgICAgICAgbXNnOiBtZXNzYWdlLkxhc3RNc2cKICAgICAgICAgIH07CiAgICAgICAgICB0aGlzLmFkZE1lc3NhZ2VIaXN0b3J5KG1lc3NhZ2UyKTsKICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZS5MYXN0TXNnCiAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICB9IC8vIOWPkeeUn+S6humUmeivr+S6i+S7tgoKCiAgICAgIHRoaXMuc29ja2V0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5sb2coJ3dlYnNvY2tldOWPkeeUn+S6humUmeivrycpOwogICAgICB9OwogICAgfQoKICB9LAoKICBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy5jbG9zZVNvY2tldCgpOwogICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7CiAgfQoKfTs="},{"version":3,"sources":["Main.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div>\n      <router-view></router-view>\n      <div class=\"footer-tabbar\" v-if=\"this.isShowFooterMenu\">\n        <van-tabbar route style=\"overflow: hidden\">\n          <van-tabbar-item replace to=\"/home\" icon=\"bi bi-house-door-fill\" :id=\"'1'\" @click=\"animate('1')\">树洞</van-tabbar-item>\n          <van-tabbar-item replace to=\"/talkList\" icon=\"bi bi-chat-dots-fill\" :id=\"'2'\" @click=\"animate('2')\">消息</van-tabbar-item>\n          <van-tabbar-item replace to=\"/mine\" icon=\"bi bi-person-circle\" :id=\"'3'\" @click=\"animate('3')\">我的</van-tabbar-item>\n        </van-tabbar>\n      </div>\n    </div>\n</template>\n\n<script>\nimport {createNamespacedHelpers} from 'vuex'\n\nconst { mapMutations, mapActions,mapState } = createNamespacedHelpers('warm')\nexport default {\n  name: 'Main',\n  computed:{\n    ...mapState(['isShowFooterMenu','user','socket','talkToWho','maxId'])\n  },\n  mounted () {\n    this.openSocket()\n    this.$router.push('/home')\n  },\n  methods:{\n    ...mapMutations(['test','setSocket','closeSocket','setChatList','addMessageHistory','increaseMaxId']),\n    ...mapActions(['addChatListAction','getChatListAction']),\n    doTest(){\n      this.test('哈哈')\n      this.testAction('hh')\n    },\n    animate (data){\n      const element = document.getElementById(data)\n      element.style.transition = 'transform 150ms linear'\n      element.style.transformOrigin='50% 0%'\n      element.style.transform = 'rotate(20deg)'\n      setTimeout(()=>{\n        element.style.transform = 'rotate(-20deg)'\n      },150)\n      setTimeout(()=>{\n        element.style.transform = 'rotate(0deg)'\n      },300)\n    },\n    openSocket () {\n      if (typeof (WebSocket) === 'undefined') {\n        console.log('您的浏览器不支持WebSocket')\n      } else {\n        console.log('您的浏览器支持WebSocket')\n        let socketUrl = 'ws://182.254.159.37:8081/ws/' + this.user.id\n        // socketUrl = socketUrl.replace('https', 'ws').replace('http', 'ws')\n        this.setSocket(new WebSocket(socketUrl))\n        // 打开事件\n        this.socket.onopen = () => {\n          this.$toast({\n            message: 'websocket已打开',\n            type: 'success'\n          })\n        }\n        // 获得消息事件\n        this.socket.onmessage = (msg) => {\n          console.log(msg.data)\n          const index=msg.data.indexOf(':')\n          console.log(index)\n          const date1 = (new Date().toLocaleDateString()).replace(/\\//g, '-')\n          const time1 = (new Date().toLocaleTimeString()).slice(2)\n          const date = date1 + ' 时间 ' + time1\n          const message={fromId:parseInt(msg.data.slice(0,index)),LastMsg:msg.data.slice(index+1),CreatedAt:date}\n          console.log(message)\n          this.addChatListAction(message)\n          this.getChatListAction()\n          console.log(this.maxId+1)\n          this.increaseMaxId()\n          const message2 = {\n            id: this.maxId+1,\n            created_at: date,\n            from: message.fromId,\n            to: this.user.id,\n            msg: message.LastMsg\n          }\n          this.addMessageHistory(message2)\n          this.$notify({type: 'success', message: message.LastMsg})\n          }\n        }\n        // 发生了错误事件\n        this.socket.onerror = function () {\n          console.log('websocket发生了错误')\n        }\n      }\n    },\n  beforeDestroy () {\n    this.closeSocket()\n    localStorage.clear()\n  }\n}\n</script>\n\n<style scoped>\n.footer-tabbar .van-tabbar-item {\n   border-top: #E2E2E2 1px solid;\n }\n\n.footer-tabbar{\n  display: block;\n  background-color: lightsteelblue!important;\n}\n</style>\n"],"sourceRoot":"src/components"}]}